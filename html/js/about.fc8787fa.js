"use strict";(self["webpackChunkkaitouchat"]=self["webpackChunkkaitouchat"]||[]).push([[443],{9911:function(t,e,s){s.r(e),s.d(e,{default:function(){return z}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"outbox"},[e("div",{staticClass:"sec-border"}),e("div",{staticClass:"first-border"}),e("div",{staticClass:"main"},[e("div",{staticClass:"friend_list"},[e("Add_chat_button",{on:{addChatHandler:t.addChatHandler}}),e("div",{staticStyle:{height:"95%","overflow-y":"scroll"}},[t._l(t.friendList,(function(s){return e("Friend_Item",{key:s.id,attrs:{id:s.id,name:s.name,group:!1},on:{switchDialog:t.switchDialog}})})),t._l(t.groupList,(function(s){return e("Friend_Item",{key:s.id,attrs:{id:s.id,name:s.name,group:!0},on:{switchDialog:t.switchDialog}})}))],2)],1),e("div",{staticClass:"chatBox"},[e("div",{staticClass:"msgBox"},t._l(t.currentMsgList,(function(s){return e("MsgBubble",{key:s.timestamp,attrs:{myself:s.userId==t.userId,speaker:s.userId,msg:s.msg,filename:s.fileName,type:s.type,progress:s.progress},on:{downloadHandler:t.downloadHandler}})})),1),e("div",{staticClass:"inputBox"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.inputmsg,expression:"inputmsg"}],attrs:{required:"",maxlength:"240"},domProps:{value:t.inputmsg},on:{input:function(e){e.target.composing||(t.inputmsg=e.target.value)}}})])]),e("ToolButton",{staticClass:"sendFileButton",attrs:{"function-name":"SendFile","chinese-name":"传输文件"},nativeOn:{click:function(e){t.showfilebox=!t.showfilebox}}}),e("ToolButton",{staticClass:"sendMsgButton",attrs:{"function-name":"SendMsg","chinese-name":"发送消息"},nativeOn:{click:function(e){return t.sendMsg.apply(null,arguments)}}})],1),t.showfilebox?e("fileSendingCard",{on:{sendFileHandler:t.sendFileHandler}}):t._e()],1)},a=[],n=(s(7658),function(){var t=this,e=t._self._c;return e("div",{staticClass:"itembox",on:{click:t.clickhandler}},[e("div",{staticClass:"icon"}),e("div",[e("ul",[e("li",{staticClass:"text"},[e("span",[t._v(t._s(1==this.group?"(群)":" ")+t._s(this.name))])]),e("li",[t._v(t._s(this.id))])])])])}),o=[],l={props:{id:{type:String},name:{type:String},group:{type:Boolean}},methods:{clickhandler(){let t={id:this.id,group:this.group};this.$emit("switchDialog",t)}}},r=l,d=s(1001),u=(0,d.Z)(r,n,o,!1,null,"410b6e99",null),c=u.exports,p=function(){var t=this,e=t._self._c;return e("div",{staticClass:"outBox"},[e("div",{staticClass:"innerBox"},[e("div",{staticClass:"titleBox"},[e("span",{staticClass:"bigText"},[t._v(t._s(this.functionName))])]),e("div",{staticClass:"textBox"},[e("span",{staticClass:"smallText"},[t._v(t._s(this.ChineseName))])])])])},h=[],g={props:{functionName:{type:String},ChineseName:{type:String}}},m=g,f=(0,d.Z)(m,p,h,!1,null,"16bb46b5",null),v=f.exports,y=function(){var t=this,e=t._self._c;return e("div",{class:{outBox:!0,"align-left":!t.myself,"align-right":t.myself}},[e("div",{class:{speaker:!t.myself,myself:t.myself}},[t._v(t._s(this.speaker))]),e("div",{staticClass:"msgBox"},[t._v(t._s(this.msg)+t._s(this.filename)),"file"==this.type&&0==this.myself?e("span",{staticStyle:{color:"green",cursor:"pointer"},on:{click:t.download}},[t._v(" "+t._s(this.downloading?"停止":"下载"))]):t._e()]),"file"==this.type&&0==this.myself?e("ProgressBar",{attrs:{progress:t.progress}}):t._e()],1)},_=[],w=function(){var t=this,e=t._self._c;return e("div",{staticClass:"progress-bar"},[e("div",{staticClass:"progress",style:{width:t.progress+"%"}})])},x=[],C={props:{progress:{type:Number}}},b=C,N=(0,d.Z)(b,w,x,!1,null,null,null),L=N.exports,B={props:{type:{type:String},speaker:{type:String},myself:{Type:Boolean},msg:{type:String},progress:{type:Number},filename:{type:String}},data(){return{downloading:!1}},methods:{download(){this.downloading=!this.downloading,this.$emit("downloadHandler",this.filename)}},components:{ProgressBar:L}},k=B,I=(0,d.Z)(k,y,_,!1,null,"63a3a9e5",null),S=I.exports,T=s(6154),D=function(){var t=this,e=t._self._c;return e("div",{staticClass:"box"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.chatName,expression:"chatName"}],staticClass:"chatName",domProps:{value:t.chatName},on:{input:function(e){e.target.composing||(t.chatName=e.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.ifGroup,expression:"ifGroup"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.ifGroup)?t._i(t.ifGroup,null)>-1:t.ifGroup},on:{change:function(e){var s=t.ifGroup,i=e.target,a=!!i.checked;if(Array.isArray(s)){var n=null,o=t._i(s,n);i.checked?o<0&&(t.ifGroup=s.concat([n])):o>-1&&(t.ifGroup=s.slice(0,o).concat(s.slice(o+1)))}else t.ifGroup=a}}}),e("button",{staticClass:"add_chat",on:{click:t.addChat}},[t._v("ADD")])])},M=[],G={data(){return{ifGroup:!1,chatName:""}},methods:{addChat(){let t={ifGroup:this.ifGroup,chatName:this.chatName};this.$emit("addChatHandler",t)}}},F=G,E=(0,d.Z)(F,D,M,!1,null,"4f5411d9",null),H=E.exports,A=function(){var t=this,e=t._self._c;return e("div",{staticClass:"box"},[e("p",{staticClass:"title"},[t._v(" ENTER FILE PATH")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.path,expression:"path"}],staticClass:"filepathinput",domProps:{value:t.path},on:{input:function(e){e.target.composing||(t.path=e.target.value)}}}),e("button",{on:{click:t.sendfiletrigger}},[t._v("发送")])])},Z=[],P={data(){return{path:""}},methods:{sendfiletrigger(){""!=this.path?this.$emit("sendFileHandler",this.path):alert("NO EMPTY PATH")}}},R=P,O=(0,d.Z)(R,A,Z,!1,null,"57ac84f2",null),q=O.exports,$={mounted(){window.AboutView=this;let t=this;t.userId=window.localStorage.getItem("username"),t.username=window.localStorage.getItem("username"),console.log(t.username),this.fetchMsgList(),this.timer=window.setInterval((()=>{setTimeout((()=>{this.fetchMsgList()}),0)}),1e3)},methods:{async getCoop(){try{let t=await T.Z.get("/api/getCoop");console.log("get Coop:"),console.log(t),this.friendList=t.data.friendList,this.groupList=t.data.groupList}catch(t){alert(t)}},async fetchMsgList(){let t=await T.Z.post("/api/fetch_msg_list");this.updateMsgListBuffer(t.data.msg)},updateMsgListBuffer(t){t.forEach((e=>{try{let s;"private"==e.source?s=this.friendList.find((t=>t.id==e.userId||t.id==e.target)):"group"==e.source&&(s=this.groupList.find((t=>t.id==e.userId||t.id==e.target))),console.log(t),console.log(s),s.msgList.push(e)}catch(s){console.warn(s)}this.refreshChatBox(this.displayDialog)})),console.log(this.friendList)},sendMsg(){if(""==this.inputmsg)return alert("empty inputbox"),0;{let e={type:"text",target:this.displayDialog,msg:this.inputmsg};console.log(e);try{T.Z.request({data:e,method:"post",url:"group"!=this.displayType?"/api/send_msg":"/api/send_group_msg"}),this.inputmsg=""}catch(t){console.log(t)}}},switchDialog(t){console.log("switch to"+t.id),this.displayType=1==t.group?"group":"private",this.displayDialog=t.id,this.refreshChatBox(t.id)},addChatHandler(t){0==t.ifGroup?this.friendList.push({id:t.chatName,name:t.chatName,msgList:[]}):this.groupList.push({id:t.chatName,name:t.chatName,msgList:[]}),this.switchDialog({id:t.chatName,name:t.chatName,group:t.isGroup})},refreshChatBox(t){this.currentMsgList.splice(0,this.currentMsgList.length);try{let e=this.friendList.find((e=>e.id==t))||this.groupList.find((e=>e.id==t));e.msgList.forEach((t=>{this.currentMsgList.push(t)}))}catch(e){console.log(e)}},triggerFileInput(){document.getElementById("file").click()},onFilepathChange(t){let e=t.target.files[0];if(console.log(e),window.FileReader){let t=new FileReader;t.readAsDataURL(e),t.onloadend=function(t){this.filepath=t.target.result,this.filepath=t.target.result,window.localStorage.setItem("filepath",t.target.result),console.log(localStorage.getItem("filepath"))}}},async sendFileHandler(t){if(""==this.displayDialog)return void alert("NO CHOSEN TARGET");let e={target:this.displayDialog,filePath:t};try{await T.Z.request({method:"post",data:e,url:"/api/send_file"})}catch(s){console.log(s)}this.showfilebox=!1},async downloadHandler(t){""!=this.displayDialog?T.Z.request({method:"post",data:{target:this.displayDialog,fileName:t,op:"start"},url:"/api/file_op"}):alert("EMPTY SENDING TARGET")}},data(){return{username:"defaultUser",userId:"zhier123",displayDialog:"",displayType:"",inputmsg:"",filepath:null,showfilebox:!1,friendList:[{id:"Bob",name:"Bob",msgList:[]}],groupList:[],currentMsgList:[]}},destroyed(){window.clearInterval(this.timer)},components:{Friend_Item:c,ToolButton:v,MsgBubble:S,Add_chat_button:H,fileSendingCard:q}},U=$,Y=(0,d.Z)(U,i,a,!1,null,"6a29962a",null),z=Y.exports},4338:function(t,e,s){s.r(e),s.d(e,{default:function(){return d}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"about"},[e("h1",[t._v("This is an about page")]),e("div",{staticClass:"inputfile"},[e("button",{attrs:{type:"primary"},on:{click:function(e){return t.openFile()}}},[t._v("选择文件")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.textarea,expression:"textarea"}],attrs:{id:"textbox",placeholder:"open file"},domProps:{value:t.textarea},on:{input:function(e){e.target.composing||(t.textarea=e.target.value)}}}),e("input",{staticStyle:{display:"none"},attrs:{type:"file",name:"filename",id:"open"},on:{change:function(e){return t.specifiName(e)},input:function(e){return t.specifiName(e)}}})])])},a=[],n={data(){return{textarea:""}},methods:{openFile(){document.getElementById("open").click()},specifiName(t){console.log(t),document.getElementById("textbox").value=document.getElementById("open").files[0].path}}},o=n,l=s(1001),r=(0,l.Z)(o,i,a,!1,null,null,null),d=r.exports}}]);
//# sourceMappingURL=about.fc8787fa.js.map